<!DOCTYPE html>
<html class="font-sans mode-dark" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>Validating data manually Lesson</title>
        <meta name="description" content="Learn programming tools like JavaScript, TypeScript, SQL, and regular expressions fast. Interactive lessons with real code examples.">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Execute Program">
<meta name="twitter:description" content="Learn it. Code it. Remember it.">
<meta name="twitter:image" content="https://www.executeprogram.com/images/twitter-card.png">
        <meta property="og:title" content="Execute Program">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.executeprogram.com/courses/advanced-typescript/lessons/validating-data-manually">
<meta property="og:image" content="https://www.executeprogram.com/images/twitter-card.png">
        <meta name="execprog-client-version" content="a831bb5c2f0473606351ad14c0b4493bc7086f029e19273bffd025af8d029b8d">
        <meta name="robots" content="index, follow">
        <link rel="prefetch" as="fetch" crossorigin="" href="https://www.executeprogram.com/dist/sql-wasm-1.4.2.wasm">
<link rel="preload" as="font" crossorigin="" href="https://www.executeprogram.com/fonts/IBMPlexSans-Regular-Latin1.woff2">
<link rel="preload" as="font" crossorigin="" href="https://www.executeprogram.com/fonts/IBMPlexSans-SemiBold-Latin1.woff2">
<link rel="preload" as="font" crossorigin="" href="https://www.executeprogram.com/fonts/IBMPlexSans-Italic-Latin1.woff2">
<link rel="preload" as="font" crossorigin="" href="https://www.executeprogram.com/fonts/Inconsolata-dz-ep.woff2">

        <link rel="stylesheet" media="all" href="Validating%20data%20manually%20Lesson_files/application.7b56579413a396ad4b75c32392fd1277e03f03872e505c38.css">
        <link rel="alternate" type="application/rss+xml" title="Execute Program Blog RSS Feed" href="https://www.executeprogram.com/blog/feed.rss">
        <script>window.USER = {"kind":"authenticated","id":29772,"email":"joelhoelting@protonmail.com","showOverlays":false}</script>
        <script type="module" src="Validating%20data%20manually%20Lesson_files/app.ZSUGA73M.js"></script>
      <link rel="canonical" href="https://www.executeprogram.com//courses/advanced-typescript/lessons/validating-data-manually"></head>
      <body class="tone-neutral bg-back flex min-h-full text-base w-full">
        <div class="App flex flex-auto justify-center"><div class="flex flex-col h-full terminal type-code w-full"><header class="
    bg-base border-b border-base
    divide-base divide-x flex justify-between sticky top-0 z-10
  "><button aria-label="Back button" class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-transparent
    px-4 py-2
    text-md
    
    
      border-0 border-base flex-0 items-center p-4 rounded-none
      hover:bg-front hover:shadow-none active:bg-back
    
  " tabindex="0" type="button"><svg aria-label="Left Arrow Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Left Arrow Icon</title><g aria-hidden="true"><path d="M8.705 4.553a.75.75 0 0 1 0 1.06L2.567 11.75H23.25a.75.75 0 0 1 .743.648L24 12.5a.75.75 0 0 1-.75.75H2.553l6.152 6.152a.75.75 0 0 1-1.06 1.06L.22 13.039A.747.747 0 0 1 0 12.5l.005.09A.754.754 0 0 1 0 12.518V12.5a.765.765 0 0 1 .003-.064.746.746 0 0 1 .28-.523l7.361-7.36a.75.75 0 0 1 1.061 0z"></path></g></svg></button><div class="flex flex-grow items-center justify-between"><a href="https://www.executeprogram.com/" class="type-h6 flex leading-none flex-shrink-0 pl-2"><img src="Validating%20data%20manually%20Lesson_files/logo-icon.svg" alt="Execute Program" aria-label="Logo" class="icon mx-2"></a><div class="flex flex-1 items-center justify-end p-3 space-x-2"></div></div><div><div class="flex items-center h-full -space-x-6"><nav aria-label="Account Navigation" class="
      flex items-center relative h-full
      false
    " role="navigation"><div class="h-full max-w-12 flex"><button aria-controls="account-nav-links" aria-expanded="false" aria-label="Toggle Account Navigation" class="
      text-strong
      false
      hover:bg-front hover:text-strong
      focusable flex items-center pointer p-4
      relative type-body-sm z-20
    " type="button"><svg aria-label="Menu Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Menu Icon</title><g aria-hidden="true"><path d="M.75 20.25h22.5a.75.75 0 1 0 0-1.5H.75a.75.75 0 1 0 0 1.5zm0-7h22.5a.75.75 0 1 0 0-1.5H.75a.75.75 0 1 0 0 1.5zm0-7h22.5a.75.75 0 1 0 0-1.5H.75a.75.75 0 0 0 0 1.5z"></path></g></svg></button></div><div class="
      border-b border-l border-t border-base
      absolute bg-base min-w-[12rem] py-2 right-0
      rounded-bl-lg shadow-lg space-y-0.5 top-full w-full z-10
    " id="account-nav-links" hidden=""><div><div class="
      bg-transparent block cursor-pointer focusable rounded-sm
      mx-2
      text-base type-body-sm
      hover:bg-front hover:text-strong
      active:bg-front active:text-strong
    "><button class="
        bg-transparent cursor-pointer focusable-text inline p-0 underline
        no-underline space-x-2 py-1 px-4 flex w-full
      " type="button"><span class="inline-flex w-4 pt-1"><svg aria-label="Refresh Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    text-accent
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Refresh Icon</title><g aria-hidden="true"><path d="M12 4a7.99 7.99 0 0 1 6.5 3.335l-.001-2.515a.75.75 0 1 1 1.5 0v4.429a.75.75 0 0 1-.75.75H14.82a.75.75 0 1 1 0-1.5l2.657-.001A6.5 6.5 0 1 0 18.424 13a.76.76 0 0 1 .756-.751.75.75 0 0 1 .75.75A7.988 7.988 0 0 1 12 20a8 8 0 1 1 0-16z"></path></g></svg></span><span class="inline-block">Toggle Dark Mode</span></button></div></div><div><div class="
      bg-transparent block cursor-pointer focusable rounded-sm
      mx-2
      text-base type-body-sm
      hover:bg-front hover:text-strong
      active:bg-front active:text-strong
    "><a class="no-underline space-x-2 py-1 px-4 flex w-full" href="https://www.executeprogram.com/courses"><span class="inline-flex w-4 pt-1"><svg aria-label="Course Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    text-accent
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Course Icon</title><g aria-hidden="true"><path d="M11.647 3.088a.75.75 0 0 1 .706 0l11.25 6a.75.75 0 0 1 0 1.324l-4.853 2.587v3.751a.75.75 0 0 1-.22.53C16.4 19.41 14.22 20.5 12 20.5c-2.22 0-4.4-1.09-6.53-3.22a.75.75 0 0 1-.21-.412l-.01-.118v-3.751l-1-.533v7.284a.75.75 0 0 1-.648.743L3.5 20.5a.75.75 0 0 1-.743-.648l-.007-.102v-8.084L.397 10.412A.75.75 0 0 1 .298 9.15l.1-.063zM17.25 13.8l-4.897 2.613a.75.75 0 0 1-.706 0L6.75 13.799v2.635l.035.035c1.696 1.62 3.351 2.45 4.972 2.525L12 19c1.617 0 3.269-.752 4.96-2.294l.29-.273v-2.634zM12 4.599L2.342 9.75l1.328.708 8.2-1.447a.75.75 0 0 1 .36 1.453l-.1.025-6.314 1.114L12 14.9l9.657-5.15L12 4.599z"></path></g></svg></span><span class="inline-block">Courses</span></a></div><div><div class="border-base border-b my-2"></div></div></div><div><div class="
      bg-transparent block cursor-pointer focusable rounded-sm
      mx-2
      text-base type-body-sm
      hover:bg-front hover:text-strong
      active:bg-front active:text-strong
    "><a class="no-underline space-x-2 py-1 px-4 flex w-full" href="https://www.executeprogram.com/account"><span class="inline-flex w-4 pt-1"><svg aria-label="Settings Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    text-accent
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Settings Icon</title><g aria-hidden="true"><path d="M8.155.001a2.71 2.71 0 0 1 2.007.894l.939 1.037a1.21 1.21 0 0 0 1.796.001l.939-1.041a2.718 2.718 0 0 1 2.009-.889 2.703 2.703 0 0 1 2.705 2.84l-.072 1.402c-.016.322.094.632.311.872a1.2 1.2 0 0 0 .837.397l.061.001.06-.001 1.4-.072c.048-.002.095-.004.143-.004a2.71 2.71 0 0 1 1.812 4.722l-1.042.939a1.206 1.206 0 0 0 0 1.794l1.042.94c.537.485.854 1.149.891 1.872a2.69 2.69 0 0 1-.694 1.954 2.704 2.704 0 0 1-1.811.888l-.189.007c-.051 0-.102-.001-.153-.004l-1.398-.072-.071-.002a1.204 1.204 0 0 0-1.198 1.272l.072 1.399a2.714 2.714 0 0 1-2.712 2.843 2.71 2.71 0 0 1-2.003-.891l-.941-1.043a1.209 1.209 0 0 0-1.795.001l-.938 1.043a2.714 2.714 0 0 1-3.825.198 2.702 2.702 0 0 1-.891-2.151l.072-1.4a1.2 1.2 0 0 0-.31-.87 1.197 1.197 0 0 0-.835-.396l-.033-.002-.03-.001c-.02 0-.04 0-.06.002l-1.401.072a2.708 2.708 0 0 1-1.951-4.717l1.041-.94a1.21 1.21 0 0 0-.001-1.795l-1.041-.939a2.714 2.714 0 0 1-.182-3.829 2.712 2.712 0 0 1 2.128-.883l1.404.072.068.002c.296 0 .582-.111.804-.312a1.206 1.206 0 0 0 .398-.964l-.072-1.4A2.713 2.713 0 0 1 8.155.001zm-.002 1.497l-.06.001a1.222 1.222 0 0 0-1.15 1.272l.072 1.399A2.709 2.709 0 0 1 4.17 7.019l-1.4-.072-.05-.001a1.21 1.21 0 0 0-.815 2.103l1.039.938a2.69 2.69 0 0 1 .89 2.149 2.692 2.692 0 0 1-.89 1.873l-1.041.94a1.206 1.206 0 0 0-.398.958 1.211 1.211 0 0 0 1.214 1.148l.056-.001 1.397-.072a2.069 2.069 0 0 1 .275 0 2.69 2.69 0 0 1 1.872.888c.485.537.732 1.23.696 1.952l-.072 1.401a1.206 1.206 0 0 0 1.207 1.27c.343 0 .67-.145.899-.399l.94-1.042a2.703 2.703 0 0 1 2.01-.892c.766 0 1.5.325 2.012.893l.94 1.042c.231.256.551.396.901.396l.056-.001a1.21 1.21 0 0 0 1.147-1.266l-.072-1.398a2.696 2.696 0 0 1 .89-2.15 2.715 2.715 0 0 1 1.953-.695l1.402.072.067.002c.344 0 .661-.142.893-.4a1.205 1.205 0 0 0-.087-1.707l-1.042-.941a2.688 2.688 0 0 1-.89-2.149 2.692 2.692 0 0 1 .89-1.873l1.042-.94c.273-.246.418-.597.399-.964a1.205 1.205 0 0 0-1.199-1.145l-.071.002-1.403.072a3.087 3.087 0 0 1-.275 0 2.691 2.691 0 0 1-1.873-.889 2.693 2.693 0 0 1-.697-1.954l.072-1.401a1.203 1.203 0 0 0-.395-.953 1.21 1.21 0 0 0-1.708.083l-.938 1.04a2.7 2.7 0 0 1-2.149.89 2.69 2.69 0 0 1-1.872-.89l-.94-1.038c-.23-.254-.557-.4-.899-.4zm3.846 5.25a5.256 5.256 0 0 1 5.25 5.25 5.256 5.256 0 0 1-5.25 5.25 5.256 5.256 0 0 1-5.25-5.25 5.256 5.256 0 0 1 5.25-5.25zm0 1.5a3.754 3.754 0 0 0-3.75 3.75 3.754 3.754 0 0 0 3.75 3.75 3.754 3.754 0 0 0 3.75-3.75 3.754 3.754 0 0 0-3.75-3.75z"></path></g></svg></span><span class="inline-block">Your Account</span></a></div></div><div><div class="
      bg-transparent block cursor-pointer focusable rounded-sm
      mx-2
      text-base type-body-sm
      hover:bg-front hover:text-strong
      active:bg-front active:text-strong
    "><button class="
        bg-transparent cursor-pointer focusable-text inline p-0 underline
        no-underline space-x-2 py-1 px-4 flex w-full
      " type="button"><span class="inline-flex w-4 pt-1"><svg aria-label="Feedback Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    text-accent
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Feedback Icon</title><g aria-hidden="true"><path d="M20.5 3.5A2.5 2.5 0 0 1 23 6v12a2.5 2.5 0 0 1-2.5 2.5h-4.879L12 24l-3.621-3.5H3.5A2.5 2.5 0 0 1 1 18V6a2.5 2.5 0 0 1 2.5-2.5h17zm0 1.5h-17l-.117.007A1 1 0 0 0 2.5 6v12l.007.117A1 1 0 0 0 3.5 19h5.086l.131.009a1 1 0 0 1 .576.284L12 22l2.707-2.707.1-.087a1 1 0 0 1 .607-.206H20.5l.117-.007A1 1 0 0 0 21.5 18V6l-.007-.117A1 1 0 0 0 20.5 5zM7 10.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3z"></path></g></svg></span><span class="inline-block">Give Feedback</span></button></div></div><div><div class="
      bg-transparent block cursor-pointer focusable rounded-sm
      mx-2
      text-base type-body-sm
      hover:bg-front hover:text-strong
      active:bg-front active:text-strong
    "><a class="no-underline space-x-2 py-1 px-4 flex w-full" href="https://www.executeprogram.com/logout"><span class="inline-flex w-4 pt-1"><svg aria-label="Log Out Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    text-accent
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Log Out Icon</title><g aria-hidden="true"><path d="M11.8 2c.397 0 .72.353.72.75s-.323.75-.72.75H4.166c-.4 0-.667.425-.667.826V19.84c0 .397.265.66.661.66h15.52c.397 0 .819-.263.819-.66v-7.63c0-.397.353-.76.75-.76s.75.363.75.76v7.63c0 1.191-1.128 2.16-2.319 2.16H4.16C2.97 22 2 21.031 2 19.84V4.326C2 3.132 2.972 2 4.166 2zm9.248 0c.166 0 .32.054.445.146l.052.042.05.05.031.035a.746.746 0 0 1 .172.568v4.752a.75.75 0 0 1-1.5 0l.002-3.022-9.02 9.018a.75.75 0 0 1-.984.067l-.076-.067a.75.75 0 0 1-.073-.977l.073-.084 9.029-9.027-3.044-.001a.75.75 0 1 1 0-1.5h4.843z"></path></g></svg></span><span class="inline-block">Log Out</span></a></div></div></div></nav></div></div></header><main class="flex flex-grow items-center justify-center"><div class="box-content max-w-2xl mx-auto px-4 py-16 tall:pb-32 xtall:pb-64 space-y-8 w-full"><h1 class="text-strong type-h2">Advanced TypeScript: Validating data manually</h1><div class="
      copy relative tone-cautious
      
      bg-base block p-2 rounded-sm sm:rounded text-base
      text-sm sm:text-md
      sm:p-4
      -mx-2 sm:-mx-4
      mb-16
    "><p>You already finished this lesson. You can read through it here,
 or use the button below to repeat the whole lesson interactively.</p><button class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-control text-control
    px-4 py-2
    text-md
    
    
  " tabindex="0" type="button"><span>Start Interactive Lesson</span></button></div><ul class="space-y-8"><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>In any static language, we'll eventually find ourselves dealing with data from outside systems.
Maybe we're accessing a third party API.
Maybe we're implementing our own API server, so we have to handle incoming API data from clients.
Maybe we're just loading some data from a JSON file on disk.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>In each of these cases, we don't know whether the data has the shape that we expect.
If we expect an object, did we actually get an object?
Or did we get an array or a number or a string?
Does the object have the properties that we expect?
If we expect the <code>message</code> property to be a string, is it actually a string, or is it something else?</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>How do we statically type data when we don't know whether it matches our expected types?
We could use <code>any</code>, but we've seen that this gives us no static guarantees at all.
The <code>unknown</code> type is better: TypeScript stops us from using the value directly.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">const</span> <span class="cm-def">json</span> <span class="cm-operator">=</span> <span class="cm-string">'{"message": "Now you have two problems."}'</span>;
<span class="cm-keyword">const</span> <span class="cm-def">parsed</span>: <span class="cm-type">unknown</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable">json</span>);
<span class="cm-keyword">const</span> <span class="cm-def">text</span>: <span class="cm-type">string</span> <span class="cm-operator">=</span> <span class="cm-variable">parsed</span>.<span class="cm-property">message</span>;
<span class="cm-variable">text</span>;</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>type error: 'parsed' is of type 'unknown'.<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>An <code>unknown</code> isn't very useful on its own.
But with some work, we can safely bring our <code>unknown</code> value 
into the world of static types.
We'll use a series of dynamic checks like "is this value actually an 
object?" and "does the object have a 'message' property?" and "is the 
property's value actually a string?"</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>A warning up front: this will be awkward.
At the end of this lesson, we'll mention some libraries designed to do this same job without so much manual work.
Still, it's important to see the manual way.
It shows how TypeScript really works, which will help you to understand what happens in real-world code.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>For our example, we'll parse a simple "comment" object stored in a JSON string like <code>'{"message": "Now you have two problems."}'</code>.
That JSON matches the static type <code>{message: string}</code>, so we want to give it that type.
But if it doesn't match that type, we want to return <code>undefined</code> instead.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>To get started, we first need to decide whether the JSON data is even an object.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">type</span> <span class="cm-type">Comment</span> <span class="cm-operator">=</span> {
  <span class="cm-property">message</span>: <span class="cm-type">string</span>
};

<span class="cm-keyword">function</span> <span class="cm-def">parseCommentJson</span>(<span class="cm-def">json</span>: <span class="cm-type">string</span>): <span class="cm-type">Comment</span> <span class="cm-operator">|</span> <span class="cm-atom">undefined</span> {
  <span class="cm-keyword">const</span> <span class="cm-def">parsed</span>: <span class="cm-type">unknown</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable-2">json</span>);
  
  <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span>) {
    <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable-2">parsed</span>.<span class="cm-property">message</span>};
  }
  
  <span class="cm-keyword">return</span> <span class="cm-atom">undefined</span>;
}

<span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"message": "Now you have two problems."}'</span>);</pre></div></div><div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6></div><div><button class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-control text-control
    px-4 py-2
    text-md
    
    mt-1
  " tabindex="0" type="button"><span>Run Code</span><svg aria-label="Right Arrow Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    opacity-50 group-hover:opacity-100
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Right Arrow Icon</title><g aria-hidden="true"><path d="M15.295 20.463a.75.75 0 0 1 0-1.061l6.138-6.137H.75a.75.75 0 0 1-.743-.648L0 12.515a.75.75 0 0 1 .648-.743l.102-.007h20.697l-6.152-6.152a.75.75 0 0 1 1.06-1.06l7.425 7.424a.747.747 0 0 1 .212.418l.007.066v.094l-.002.024a.746.746 0 0 1-.28.523l-7.361 7.36a.75.75 0 0 1-1.061 0z"></path></g></svg></button></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>We narrowed <code>parsed</code>'s type to <code>object</code>, then we tried to access <code>parsed.message</code>.
It would make sense to get a type error like "Property 'message' does not exist."
Instead, we get "'parsed' is possibly 'null'".
Why?</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>The reason is that <code>typeof null === 'object'</code> in both JavaScript and TypeScript.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">typeof</span> <span class="cm-atom">null</span>;</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>'object'<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>This is an unfortunate part of JavaScript, but we have to deal with it.
<code>typeof parsed === 'object'</code> doesn't mean that <code>parsed</code> is what we normally think of as an object, like <code>{}</code> or <code>{name: 'Amir'}</code>.
It might be <code>null</code>.
This narrows <code>parsed</code> to <code>object | null</code>, which explains our type error above.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>The next example is the same as the previous version, but we've added a <code>parsed !== null</code> check to make sure that <code>parsed</code> really is an object.
Now we get the "property does not exist" error message that we expected.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">type</span> <span class="cm-type">Comment</span> <span class="cm-operator">=</span> {
  <span class="cm-property">message</span>: <span class="cm-type">string</span>
};

<span class="cm-keyword">function</span> <span class="cm-def">parseCommentJson</span>(<span class="cm-def">json</span>: <span class="cm-type">string</span>): <span class="cm-type">Comment</span> <span class="cm-operator">|</span> <span class="cm-atom">undefined</span> {
  <span class="cm-keyword">const</span> <span class="cm-def">parsed</span>: <span class="cm-type">unknown</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable-2">json</span>);
  <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">parsed</span> <span class="cm-operator">!==</span> <span class="cm-atom">null</span>) {
      <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable-2">parsed</span>.<span class="cm-property">message</span>};
    }
  }
  <span class="cm-keyword">return</span> <span class="cm-atom">undefined</span>;
}

<span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"message": "Now you have two problems."}'</span>);</pre></div></div><div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6></div><div><button class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-control text-control
    px-4 py-2
    text-md
    
    mt-1
  " tabindex="0" type="button"><span>Run Code</span><svg aria-label="Right Arrow Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    opacity-50 group-hover:opacity-100
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Right Arrow Icon</title><g aria-hidden="true"><path d="M15.295 20.463a.75.75 0 0 1 0-1.061l6.138-6.137H.75a.75.75 0 0 1-.743-.648L0 12.515a.75.75 0 0 1 .648-.743l.102-.007h20.697l-6.152-6.152a.75.75 0 0 1 1.06-1.06l7.425 7.424a.747.747 0 0 1 .212.418l.007.066v.094l-.002.024a.746.746 0 0 1-.28.523l-7.361 7.36a.75.75 0 0 1-1.061 0z"></path></g></svg></button></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>That's progress: TypeScript now knows that <code>parsed</code> is a real, non-null object, but it doesn't know what properties that object has.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>Now we need to check for whether the <code>message</code> property exists.
JavaScript has an <code>in</code> operator for that purpose.
Ideally, we'd use that: <code>if ('message' in parsed) { ... }</code>.
Unfortunately, TypeScript doesn't treat the <code>in</code> as a type guard, so this doesn't work.
We'd still get the same error message as above.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>Instead, we can write a small type predicate function to check the "message" property.
Remember that TypeScript can't check for whether our type predicate function's body is correct.
Fortunately, this type predicate is short so it's easy to verify by careful inspection.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">type</span> <span class="cm-type">Comment</span> <span class="cm-operator">=</span> {
  <span class="cm-property">message</span>: <span class="cm-type">string</span>
};

<span class="cm-keyword">function</span> <span class="cm-def">hasMessageProperty</span>(<span class="cm-def">obj</span>: {}): <span class="cm-variable-2">obj</span> <span class="cm-keyword">is</span> {<span class="cm-property">message</span>: <span class="cm-type">unknown</span>} {
  <span class="cm-keyword">return</span> <span class="cm-string">'message'</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">obj</span>;
}

<span class="cm-keyword">function</span> <span class="cm-def">parseCommentJson</span>(<span class="cm-def">json</span>: <span class="cm-type">string</span>): <span class="cm-type">Comment</span> <span class="cm-operator">|</span> <span class="cm-atom">undefined</span> {
  <span class="cm-keyword">const</span> <span class="cm-def">parsed</span>: <span class="cm-type">unknown</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable-2">json</span>);
  <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">parsed</span> <span class="cm-operator">!==</span> <span class="cm-atom">null</span>) {
      <span class="cm-keyword">if</span> (<span class="cm-variable">hasMessageProperty</span>(<span class="cm-variable-2">parsed</span>)) {
        <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable-2">parsed</span>.<span class="cm-property">message</span>};
      }
    }
  }
  <span class="cm-keyword">return</span> <span class="cm-atom">undefined</span>;
}

<span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"message": "Now you have two problems."}'</span>);</pre></div></div><div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6></div><div><button class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-control text-control
    px-4 py-2
    text-md
    
    mt-1
  " tabindex="0" type="button"><span>Run Code</span><svg aria-label="Right Arrow Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    opacity-50 group-hover:opacity-100
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Right Arrow Icon</title><g aria-hidden="true"><path d="M15.295 20.463a.75.75 0 0 1 0-1.061l6.138-6.137H.75a.75.75 0 0 1-.743-.648L0 12.515a.75.75 0 0 1 .648-.743l.102-.007h20.697l-6.152-6.152a.75.75 0 0 1 1.06-1.06l7.425 7.424a.747.747 0 0 1 .212.418l.007.066v.094l-.002.024a.746.746 0 0 1-.28.523l-7.361 7.36a.75.75 0 0 1-1.061 0z"></path></g></svg></button></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>We're successfully accessing <code>parsed.message</code>, but the <code>message</code> property is still <code>unknown</code>.
The final step is to check <code>message</code>'s type.
Another <code>typeof</code> type guard will achieve that.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">type</span> <span class="cm-type">Comment</span> <span class="cm-operator">=</span> {
  <span class="cm-property">message</span>: <span class="cm-type">string</span>
};

<span class="cm-keyword">function</span> <span class="cm-def">hasMessageProperty</span>(<span class="cm-def">obj</span>: {}): <span class="cm-variable-2">obj</span> <span class="cm-keyword">is</span> {<span class="cm-property">message</span>: <span class="cm-type">unknown</span>} {
  <span class="cm-keyword">return</span> <span class="cm-string">'message'</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">obj</span>;
}

<span class="cm-keyword">function</span> <span class="cm-def">parseCommentJson</span>(<span class="cm-def">json</span>: <span class="cm-type">string</span>): <span class="cm-type">Comment</span> <span class="cm-operator">|</span> <span class="cm-atom">undefined</span> {
  <span class="cm-keyword">const</span> <span class="cm-def">parsed</span>: <span class="cm-type">unknown</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable-2">json</span>);
  <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">parsed</span> <span class="cm-operator">!==</span> <span class="cm-atom">null</span>) {
      <span class="cm-keyword">if</span> (<span class="cm-variable">hasMessageProperty</span>(<span class="cm-variable-2">parsed</span>)) {
        <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">parsed</span>.<span class="cm-property">message</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span>) {
          <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable-2">parsed</span>.<span class="cm-property">message</span>};
        }
      }
    }
  }
  <span class="cm-keyword">return</span> <span class="cm-atom">undefined</span>;
}</pre></div></div><div><div></div></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>This version works!
When the JSON data matches our expectations, we get the <code>{message: ...}</code> object back.
When it doesn't match, we get <code>undefined</code>.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="mb-2"><div class="tone-cautious text-muted text-sm">Note: this code example reuses elements (variables, etc.) defined in earlier examples.</div></div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"message": "Now you have two problems."}'</span>);</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>{message: 'Now you have two problems.'}<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="mb-2"><div class="tone-cautious text-muted text-sm">Note: this code example reuses elements (variables, etc.) defined in earlier examples.</div></div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'123'</span>);</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>undefined<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="mb-2"><div class="tone-cautious text-muted text-sm">Note: this code example reuses elements (variables, etc.) defined in earlier examples.</div></div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"text": "Now you have two problems."}'</span>);</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>undefined<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="mb-2"><div class="tone-cautious text-muted text-sm">Note: this code example reuses elements (variables, etc.) defined in earlier examples.</div></div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"message": {"message": "Now you have two problems."}}'</span>);</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>undefined<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="space-y-2"><div class="
      bg-base -mx-4 p-4 text-base shadow
      focus-within:shadow-lg
      md:rounded-md
    "><div class="mb-2"><div class="tone-cautious text-muted text-sm">Note: this code example reuses elements (variables, etc.) defined in earlier examples.</div></div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-variable">parseCommentJson</span>(<span class="cm-string">'{"error": "Service temporarily unavailable."}'</span>);</pre></div><h6 class="font-bold inline-block text-muted tracking-wider type-code-sm uppercase">Result:</h6><div class="
      text-muted
      tone-positive
    "><pre>undefined<svg aria-label="Pass Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    
    
      tone-positive tone-as-loud
      bg-control h-em ml-2
      rounded-full text-control top-[0.2em] w-em
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Pass Icon</title><g aria-hidden="true"><path d="M8.75 17.882l-4.359-4.359a.75.75 0 0 1 1.06-1.06l4.006 4.005 9.005-9.006a.75.75 0 0 1 1.061 1.061l-9.359 9.359a1 1 0 0 1-1.414 0z"></path></g></svg></pre></div><div class="text-muted type-code-sm"></div><div class="flex sm-down:flex-col sm-down:space-y-2"></div></div></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>That was a lot of work, and our function is quite awkward.
But it's important to appreciate what we did here.
We handled four different error cases, all of which can happen in reality:</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><ul>
<li>The JSON value might not be an object at all.</li>
<li>It might be <code>null</code>, which is an object in JavaScript but not the kind of object we expect.</li>
<li>It might not have the <code>message</code> property that we expect.</li>
<li>It might have a <code>message</code>, but with an unexpected type.</li>
</ul>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>We
 could write those checks in any language, including regular JavaScript.
The benefit of using TypeScript is that the compiler showed us each of 
these potential problems; we just had to think about why the type errors
 happened, then write type guards to handle them.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>Regardless of our programming language, we have to choose the level of safety that we want when validating outside data.
Here are some common options:</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><ol>
<li>We can choose to have no safety at all.
In TypeScript, this means using <code>any</code>, or forcing the type with <code>parsed as Comment</code>.
If the runtime data is wrong, we won't know, just as we wouldn't know in JavaScript.</li>
<li>We can implement checks manually, like we did in this lesson.
This gives us good confidence, but requires a lot of extra code.
(Imagine repeating this process for a hundred complex API endpoints, many of which have deeply nested objects!)</li>
<li>We can implement checks with a third-party data validation library like <a href="https://github.com/gcanti/io-ts" target="_blank">io-ts</a> or <a href="https://github.com/pelotom/runtypes" target="_blank">runtypes</a>.
This gives us even more confidence than we get with our manual checks, and it requires less code.
The trade-off is that we have to learn how to use the library.</li>
</ol>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>The
 best option will depend on your project and your team.
Are you writing code for a financial application, or for a healthcare 
system, or for authentication and authorization of users?
If so, you probably want very strict, formalized checks on all data.
Are you writing an internal analytics dashboard, where bugs won't be 
visible to customers and can't cause incorrect data to end up in a 
database?
If so, it may be fine to use <code>any</code> or <code>as</code> to skip the data validation step.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>A note about our syntax in this lesson.
The final version of our code contained four levels of nested <code>if</code>s.
Each <code>if</code> acted as a type guard for the next <code>if</code>.
After the fourth type guard, our object was dynamically checked, and its static type was also fully narrowed.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>We wrote the <code>if</code>s in that way because it made our incremental changes easier to follow.
However, TypeScript is quite good at narrowing types, so we could've written our code with only one <code>if</code>.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>The examples in this lesson did this:</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span>) {
  <span class="cm-keyword">if</span> (<span class="cm-variable">parsed</span> <span class="cm-operator">!==</span> <span class="cm-atom">null</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable">hasMessageProperty</span>(<span class="cm-variable">parsed</span>)) {
      <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable">parsed</span>.<span class="cm-property">message</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span>) {
        <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable">parsed</span>.<span class="cm-property">message</span>};
      }
    }
  }
}</pre></div></div><div><div></div></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>It works fine.
But we could've written this instead:</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="Example"><div class="bg-base mb-8 -mx-4 p-4 md:rounded-md shadow"><div><div class="flex"><pre class="mr-2">&gt;</pre><pre class="cm-s-execprog"><span class="cm-keyword">if</span> (
  <span class="cm-keyword">typeof</span> <span class="cm-variable">parsed</span> <span class="cm-operator">===</span> <span class="cm-string">'object'</span> <span class="cm-operator">&amp;&amp;</span>
  <span class="cm-variable">parsed</span> <span class="cm-operator">!==</span> <span class="cm-atom">null</span> <span class="cm-operator">&amp;&amp;</span>
  <span class="cm-variable">hasMessageProperty</span>(<span class="cm-variable">parsed</span>) <span class="cm-operator">&amp;&amp;</span>
  <span class="cm-keyword">typeof</span> <span class="cm-variable">parsed</span>.<span class="cm-property">message</span> <span class="cm-operator">===</span> <span class="cm-string">'string'</span>
) {
  <span class="cm-keyword">return</span> {<span class="cm-property">message</span>: <span class="cm-variable">parsed</span>.<span class="cm-property">message</span>};
}</pre></div></div><div><div></div></div></div><div class="mb-8"></div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>We could also collapse the <code>if</code> condition onto one line, but that would make it so long that it wouldn't fit in our lesson UI!</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>The types and runtime behavior of these two is the same.
In each <code>&amp;&amp;</code>, the expression on the left acts as a type guard for the expression on the right.
From a type perspective, the chain of <code>&amp;&amp;</code>s acts like a series of <code>if</code> conditionals.</p>
</div></div></li><li class="
          step
          finished-step
        "><div class="mb-4 space-y-4"><div class="copy type-code "><p>Finally, a note about safety when working with JSON in particular.
Unfortunately, TypeScript's type definitions for <code>JSON.parse</code> have a return type of <code>any</code>.
That's because old versions of TypeScript didn't have the <code>unknown</code> type at all, and changing <code>JSON.parse</code>'s type now would break a lot of code.
This makes <code>JSON.parse</code> dangerous, because that <code>any</code> defeats the type system.
When using <code>JSON.parse</code>, it's best to explicitly specify the <code>unknown</code> type, like <code>const parsed: unknown = JSON.parse(json)</code>.</p>
</div></div></li></ul></div></main><div class="reference tone-neutral"><button class="

    button tone-accent
    border-2 border-control cursor-pointer font-bold font-mono group
    inline-flex items-center justify-between leading-none no-underline rounded
    space-x-2 whitespace-nowrap
    hover:shadow-md
    focusable
    bg-transparent
    px-4 py-2
    text-md
    flex-row-reverse space-x-reverse
    bg-base hover:bg-front bottom-4 fixed right-4 shadow-lg z-50
  " tabindex="0" type="button"><span>Show Reference</span><svg aria-label="Reference Icon" class="
    align-baseline fill-current inline-block relative
    
    
    h-em w-em
    opacity-50 group-hover:opacity-100
    
  " height="24" role="img" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Reference Icon</title><g aria-hidden="true"><path d="M16.5 0a1.5 1.5 0 0 1 1.06.44l3 3A1.5 1.5 0 0 1 21 4.5v18a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 3 22.5v-21A1.5 1.5 0 0 1 4.5 0zm-1.25 1.5H4.5v21h15V5.749L16 5.75a.75.75 0 0 1-.743-.648L15.25 5V1.5zm-2 16.5a.75.75 0 1 1 0 1.5h-6.5a.75.75 0 1 1 0-1.5h6.5zm3-3a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 1 1 0-1.5h9.5zm.345-7.585l.181.186.818.873a1.5 1.5 0 0 1 .101 1.932l-.1.12-.819.873c-2.566 2.738-6.732 2.8-9.37.186l-.182-.186-.818-.873a1.5 1.5 0 0 1-.101-1.932l.1-.12.819-.873c2.566-2.738 6.732-2.8 9.37-.186zM8.49 8.45l-.173.176L7.5 9.5l.818.873c1.977 2.11 5.148 2.168 7.191.176l.173-.176.818-.873-.818-.873c-1.977-2.11-5.148-2.168-7.191-.176zm5.153-.78l.06.061a2.547 2.547 0 0 1 0 3.536 2.368 2.368 0 0 1-3.348.06l-.06-.06a2.547 2.547 0 0 1 0-3.536 2.368 2.368 0 0 1 3.348-.06zm-2.269 1.102a1.047 1.047 0 0 0-.093 1.348l.074.086.041.042a.868.868 0 0 0 1.228-.022c.363-.377.389-.958.078-1.363l-.078-.09-.022-.023a.868.868 0 0 0-1.228.022zM16.75 1.75v2.5l2.499-.001L16.75 1.75z"></path></g></svg></button></div></div></div>
      
    </body></html>